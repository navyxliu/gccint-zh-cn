<html lang="zh">
<head>
<title>Target Fragment - GNU Compiler Collection (GCC) Internals</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="GNU Compiler Collection (GCC) Internals">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="Fragments.html#Fragments" title="Fragments">
<link rel="next" href="Host-Fragment.html#Host-Fragment" title="Host Fragment">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
版权 (C) 1988, 1989, 1992, 1993, 1994, 1995, 1996, 1997, 1998,
1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2010 自由软件基金会

您可以依据自由软件基金会所发行的GNU自由文档授权1.3版本或者之后的任何版本，对本文档进行复制，分发和/或修改；其中不可变章节为"资助自由软件"，封面文字为 (a) (参见下面)，以及封底文字为 (b) (参见下面)。授权的副本要被包含在标题为"GNU自由文档授权"的章节中。

(a) FSF的封面文字为：

     GNU 手册

(b) FSF的封底文字为：

     您可以自由复制和修改本GNU手册，如同GNU软件。由自由软件基金会所发行的副本用于为GNU开发筹集资金。-->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<a name="Target-Fragment"></a>
<p>
Next:&nbsp;<a rel="next" accesskey="n" href="Host-Fragment.html#Host-Fragment">Host Fragment</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="Fragments.html#Fragments">Fragments</a>
<hr>
</div>

<h3 class="section">19.1 目标机Makefile片段</h3>

<p><a name="index-target-makefile-fragment-4925"></a><a name="index-g_t_0040file_007bt_002d_0040var_007btarget_007d_007d-4926"></a>
<!-- Target makefile fragments can set these Makefile variables. -->
目标makefile片段能够设置这些Makefile变量。

     
<a name="index-LIBGCC2_005fCFLAGS-4927"></a>
<dl><dt><code>LIBGCC2_CFLAGS</code><dd><!-- Compiler flags to use when compiling @file{libgcc2.c}. -->
编译<samp><span class="file">libgcc2.c</span></samp>时使用的编译器标记。

     <p><a name="index-LIB2FUNCS_005fEXTRA-4928"></a><br><dt><code>LIB2FUNCS_EXTRA</code><dd><!-- A list of source file names to be compiled or assembled and inserted -->
<!-- into @file{libgcc.a}. -->
将被编译或汇编，并插入<samp><span class="file">libgcc.a</span></samp>的源文件名列表。

     <p><a name="index-Floating-Point-Emulation-4929"></a><br><dt><code>Floating Point Emulation</code><dd><!-- To have GCC include software floating point libraries in @file{libgcc.a} -->
<!-- define @code{FPBIT} and @code{DPBIT} along with a few rules as follows: -->
要使GCC在 <samp><span class="file">libgcc.a</span></samp> 中包括软浮点库，则使用下面的一些规则来定义 <code>FPBIT</code> 和 <code>DPBIT</code>：

     <pre class="smallexample">          # We want fine grained libraries, so use the new code
          # to build the floating point emulation libraries.
          FPBIT = fp-bit.c
          DPBIT = dp-bit.c
          
          
          fp-bit.c: $(srcdir)/config/fp-bit.c
                  echo '#define FLOAT' &gt; fp-bit.c
                  cat $(srcdir)/config/fp-bit.c &gt;&gt; fp-bit.c
          
          dp-bit.c: $(srcdir)/config/fp-bit.c
                  cat $(srcdir)/config/fp-bit.c &gt; dp-bit.c
</pre>
     <!-- You may need to provide additional #defines at the beginning of @file{fp-bit.c} -->
     <!-- and @file{dp-bit.c} to control target endianness and other options. -->
     <p>可能需要在<samp><span class="file">fp-bit.c</span></samp>和<samp><span class="file">dp-bit.c</span></samp>的开始处提供额外的#define来控制目标机大小端和其它选项。

     <p><a name="index-CRTSTUFF_005fT_005fCFLAGS-4930"></a><br><dt><code>CRTSTUFF_T_CFLAGS</code><dd><!-- Special flags used when compiling @file{crtstuff.c}. -->
<!-- @xref{Initialization}. -->
编译<samp><span class="file">crtstuff.c</span></samp>时使用的特定标记。参见<a href="Initialization.html#Initialization">Initialization</a>。

     <p><a name="index-CRTSTUFF_005fT_005fCFLAGS_005fS-4931"></a><br><dt><code>CRTSTUFF_T_CFLAGS_S</code><dd><!-- Special flags used when compiling @file{crtstuff.c} for shared -->
<!-- linking.  Used if you use @file{crtbeginS.o} and @file{crtendS.o} -->
<!-- in @code{EXTRA-PARTS}. -->
<!-- @xref{Initialization}. -->
编译共享连接的<samp><span class="file">crtstuff.c</span></samp>时使用的特定标记。用于在<code>EXTRA-PARTS</code>中使用<samp><span class="file">crtbeginS.o</span></samp>和<samp><span class="file">crtendS.o</span></samp>时。参见<a href="Initialization.html#Initialization">Initialization</a>。

     <p><a name="index-MULTILIB_005fOPTIONS-4932"></a><br><dt><code>MULTILIB_OPTIONS</code><dd><!-- For some targets, invoking GCC in different ways produces objects -->
<!-- that can not be linked together.  For example, for some targets GCC -->
<!-- produces both big and little endian code.  For these targets, you must -->
<!-- arrange for multiple versions of @file{libgcc.a} to be compiled, one for -->
<!-- each set of incompatible options.  When GCC invokes the linker, it -->
<!-- arranges to link in the right version of @file{libgcc.a}, based on -->
<!-- the command line options used. -->
对于一些目标机，使用不同方式调用GCC所产生的目标对象不能被一起连接。例如，对于一些目标机，GCC可产生大端和小端代码。对于这些目标机，必须安排编译多个版本的<samp><span class="file">libgcc.a</span></samp>，对应于每个不相兼容的选项集。当GCC调用连接器时，它会根据使用的命令行选项来安排连接正确版本的<samp><span class="file">libgcc.a</span></samp>。

     <!-- The @code{MULTILIB_OPTIONS} macro lists the set of options for which -->
     <!-- special versions of @file{libgcc.a} must be built.  Write options that -->
     <!-- are mutually incompatible side by side, separated by a slash.  Write -->
     <!-- options that may be used together separated by a space.  The build -->
     <!-- procedure will build all combinations of compatible options. -->
     <p><code>MULTILIB_OPTIONS</code>宏列出了必须构建特定版本<samp><span class="file">libgcc.a</span></samp>的选项集。将互不兼容的选项并排写出，并由斜线分隔。将可以一起使用的选项由空格分开。构建程序将会构建所有兼容选项的组合。

     <!-- For example, if you set @code{MULTILIB_OPTIONS} to @samp{m68000/m68020 -->
     <!-- msoft-float}, @file{Makefile} will build special versions of -->
     <!-- @file{libgcc.a} using the following sets of options:  @option{-m68000}, -->
     <!-- @option{-m68020}, @option{-msoft-float}, @samp{-m68000 -msoft-float}, and -->
     <!-- @samp{-m68020 -msoft-float}. -->
     <p>例如，如果将<code>MULTILIB_OPTIONS</code>设置为&lsquo;<samp><span class="samp">m68000/m68020 msoft-float</span></samp>&rsquo;，<samp><span class="file">Makefile</span></samp>将会使用下列选项集来构建特定版本的<samp><span class="file">libgcc.a</span></samp>：<samp><span class="option">-m68000</span></samp>, <samp><span class="option">-m68020</span></samp>, <samp><span class="option">-msoft-float</span></samp>, &lsquo;<samp><span class="samp">-m68000 -msoft-float</span></samp>&rsquo;, 和&lsquo;<samp><span class="samp">-m68020 -msoft-float</span></samp>&rsquo;。

     <p><a name="index-MULTILIB_005fDIRNAMES-4933"></a><br><dt><code>MULTILIB_DIRNAMES</code><dd><!-- If @code{MULTILIB_OPTIONS} is used, this variable specifies the -->
<!-- directory names that should be used to hold the various libraries. -->
<!-- Write one element in @code{MULTILIB_DIRNAMES} for each element in -->
<!-- @code{MULTILIB_OPTIONS}.  If @code{MULTILIB_DIRNAMES} is not used, the -->
<!-- default value will be @code{MULTILIB_OPTIONS}, with all slashes treated -->
<!-- as spaces. -->
如果使用了<code>MULTILIB_OPTIONS</code>，该变量指定了用于存放不同库的目录名。<code>MULTILIB_OPTIONS</code>中的每个元素，对应于<code>MULTILIB_DIRNAMES</code>中的每个元素。如果没有使用<code>MULTILIB_DIRNAMES</code>，缺省值将为<code>MULTILIB_OPTIONS</code>，并使用斜线来替代空格。

     <!-- For example, if @code{MULTILIB_OPTIONS} is set to @samp{m68000/m68020 -->
     <!-- msoft-float}, then the default value of @code{MULTILIB_DIRNAMES} is -->
     <!-- @samp{m68000 m68020 msoft-float}.  You may specify a different value if -->
     <!-- you desire a different set of directory names. -->
     <p>例如，如果<code>MULTILIB_OPTIONS</code>设置为&lsquo;<samp><span class="samp">m68000/m68020 msoft-float</span></samp>&rsquo;，则<code>MULTILIB_DIRNAMES</code>的缺省值为&lsquo;<samp><span class="samp">m68000 m68020 msoft-float</span></samp>&rsquo;。如果需要不同的目录名时，可以指定不同的值。

     <p><a name="index-MULTILIB_005fMATCHES-4934"></a><br><dt><code>MULTILIB_MATCHES</code><dd><!-- Sometimes the same option may be written in two different ways.  If an -->
<!-- option is listed in @code{MULTILIB_OPTIONS}, GCC needs to know about -->
<!-- any synonyms.  In that case, set @code{MULTILIB_MATCHES} to a list of -->
<!-- items of the form @samp{option=option} to describe all relevant -->
<!-- synonyms.  For example, @samp{m68000=mc68000 m68020=mc68020}. -->
有时，相同的选项可以被写成两种不同的方式。如果一个选项在<code>MULTILIB_OPTIONS</code>式列出，GCC需要知道它的任何同义形式。这种情况下，将<code>MULTILIB_MATCHES</code>设置为&lsquo;<samp><span class="samp">option=option</span></samp>&rsquo;形式的列表来描述所有相关的同义词。例如，&lsquo;<samp><span class="samp">m68000=mc68000 m68020=mc68020</span></samp>&rsquo;。

     <p><a name="index-MULTILIB_005fEXCEPTIONS-4935"></a><br><dt><code>MULTILIB_EXCEPTIONS</code><dd><!-- Sometimes when there are multiple sets of @code{MULTILIB_OPTIONS} being -->
<!-- specified, there are combinations that should not be built.  In that -->
<!-- case, set @code{MULTILIB_EXCEPTIONS} to be all of the switch exceptions -->
<!-- in shell case syntax that should not be built. -->
有时，当<code>MULTILIB_OPTIONS</code>中指定了多个选项集时，会有些组合不能被构建。这种情况下，将<code>MULTILIB_EXCEPTIONS</code>设置为所有不被构建的例外。

     <!-- For example the ARM processor cannot execute both hardware floating -->
     <!-- point instructions and the reduced size THUMB instructions at the same -->
     <!-- time, so there is no need to build libraries with both of these -->
     <!-- options enabled.  Therefore @code{MULTILIB_EXCEPTIONS} is set to: -->
     <p>例如ARM处理器不能执行同时执行硬件浮点指令和缩减大小的THUMB指令，这样就没有必要构建这些选项组合的库。因此将<code>MULTILIB_EXCEPTIONS</code>设为：

     <pre class="smallexample">          *mthumb/*mhard-float*
</pre>
     <p><a name="index-MULTILIB_005fEXTRA_005fOPTS-4936"></a><br><dt><code>MULTILIB_EXTRA_OPTS</code><dd><!-- Sometimes it is desirable that when building multiple versions of -->
<!-- @file{libgcc.a} certain options should always be passed on to the -->
<!-- compiler.  In that case, set @code{MULTILIB_EXTRA_OPTS} to be the list -->
<!-- of options to be used for all builds.  If you set this, you should -->
<!-- probably set @code{CRTSTUFF_T_CFLAGS} to a dash followed by it. -->
有时当构建多版本<samp><span class="file">libgcc.a</span></samp>时，有些选项需要总是被传给编译器。这种情况下，将<code>MULTILIB_EXTRA_OPTS</code>设置为用于所有构建时的选项列表。如果设置了该宏，则可能要将<code>CRTSTUFF_T_CFLAGS</code>设置为跟在其后的破折号。

     <p><a name="index-NATIVE_005fSYSTEM_005fHEADER_005fDIR-4937"></a><br><dt><code>NATIVE_SYSTEM_HEADER_DIR</code><dd><!-- If the default location for system headers is not @file{/usr/include}, -->
<!-- you must set this to the directory containing the headers.  This value -->
<!-- should match the value of the @code{SYSTEM_INCLUDE_DIR} macro. -->
如果系统头文件的缺省位置不是<samp><span class="file">/usr/include</span></samp>，则必须将该宏设置为包含头文件的目录。该值应该匹配<code>SYSTEM_INCLUDE_DIR</code>宏的值。

     <p><a name="index-SPECS-4938"></a><br><dt><code>SPECS</code><dd><!-- Unfortunately, setting @code{MULTILIB_EXTRA_OPTS} is not enough, since -->
<!-- it does not affect the build of target libraries, at least not the -->
<!-- build of the default multilib.  One possible work-around is to use -->
<!-- @code{DRIVER_SELF_SPECS} to bring options from the @file{specs} file -->
<!-- as if they had been passed in the compiler driver command line. -->
<!-- However, you don't want to be adding these options after the toolchain -->
<!-- is installed, so you can instead tweak the @file{specs} file that will -->
<!-- be used during the toolchain build, while you still install the -->
<!-- original, built-in @file{specs}.  The trick is to set @code{SPECS} to -->
<!-- some other filename (say @file{specs.install}), that will then be -->
<!-- created out of the built-in specs, and introduce a @file{Makefile} -->
<!-- rule to generate the @file{specs} file that's going to be used at -->
<!-- build time out of your @file{specs.install}. -->
不幸的是，设置<code>MULTILIB_EXTRA_OPTS</code>并不足够，因为它并不影响目标库的构建，最起码对于缺省multilib的构建是这样的。一种可能的方法是使用<code>DRIVER_SELF_SPECS</code>从<samp><span class="file">specs</span></samp>文件中取得选项，就像是它们被传给了编译器驱动程序的命令行。但是，你不想在安装工具链之后再增加这些选项，所以你可以在安装原始的内嵌<samp><span class="file">specs</span></samp>时，调节在构建工具链时使用的<samp><span class="file">specs</span></samp>文件。诀窍是将<code>SPECS</code>设置为其它文件名（例如<samp><span class="file">specs.install</span></samp>），然后该文件将会由内建<samp><span class="file">specs</span></samp>创建出来，并且引出一个<samp><span class="file">Makefile</span></samp>规则来生成<samp><span class="file">specs</span></samp>文件，在构建时候使用。

     <br><dt><code>T_CFLAGS</code><dd><!-- These are extra flags to pass to the C compiler.  They are used both -->
<!-- when building GCC, and when compiling things with the just-built GCC@. -->
<!-- This variable is deprecated and should not be used. -->
这些是传递给C编译器的额外标记。用于构建GCC，以及使用刚构建好的GCC来编译东西的时候。该变量已经被废弃，不要再使用了。
</dl>

<!-- @node Host Fragment -->
<!-- @section Host Makefile Fragments -->
 </body></html>

