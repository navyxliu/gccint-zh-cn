<html lang="zh">
<head>
<title>OpenMP - GNU Compiler Collection (GCC) Internals</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="GNU Compiler Collection (GCC) Internals">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="Statements.html#Statements" title="Statements">
<link rel="prev" href="Cleanups.html#Cleanups" title="Cleanups">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
版权 (C) 1988, 1989, 1992, 1993, 1994, 1995, 1996, 1997, 1998,
1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2010 自由软件基金会

您可以依据自由软件基金会所发行的GNU自由文档授权1.3版本或者之后的任何版本，对本文档进行复制，分发和/或修改；其中不可变章节为"资助自由软件"，封面文字为 (a) (参见下面)，以及封底文字为 (b) (参见下面)。授权的副本要被包含在标题为"GNU自由文档授权"的章节中。

(a) FSF的封面文字为：

     GNU 手册

(b) FSF的封底文字为：

     您可以自由复制和修改本GNU手册，如同GNU软件。由自由软件基金会所发行的副本用于为GNU开发筹集资金。-->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<a name="OpenMP"></a>
<p>
Previous:&nbsp;<a rel="previous" accesskey="p" href="Cleanups.html#Cleanups">Cleanups</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="Statements.html#Statements">Statements</a>
<hr>
</div>

<h4 class="subsection">11.7.7 OpenMP</h4>

<p><a name="index-OMP_005fPARALLEL-2534"></a><a name="index-OMP_005fFOR-2535"></a><a name="index-OMP_005fSECTIONS-2536"></a><a name="index-OMP_005fSINGLE-2537"></a><a name="index-OMP_005fSECTION-2538"></a><a name="index-OMP_005fMASTER-2539"></a><a name="index-OMP_005fORDERED-2540"></a><a name="index-OMP_005fCRITICAL-2541"></a><a name="index-OMP_005fRETURN-2542"></a><a name="index-OMP_005fCONTINUE-2543"></a><a name="index-OMP_005fATOMIC-2544"></a><a name="index-OMP_005fCLAUSE-2545"></a>
<!-- All the statements starting with @code{OMP_} represent directives and -->
<!-- clauses used by the OpenMP API @w{@uref{http://www.openmp.org/}}. -->
所有以<code>OMP_</code>开头的语句，都表示OpenMP API <a href="http://www.openmp.org/">http://www.openmp.org/</a><!-- /@w -->所用到的directives和clauses。

     <dl>
<dt><code>OMP_PARALLEL</code><dd>
<!-- Represents @code{#pragma omp parallel [clause1 @dots{} clauseN]}. It -->
<!-- has four operands: -->
表示<code>#pragma omp parallel [clause1 ... clauseN]</code>。具有四个操作数：

     <!-- Operand @code{OMP_PARALLEL_BODY} is valid while in GENERIC and -->
     <!-- High GIMPLE forms.  It contains the body of code to be executed -->
     <!-- by all the threads.  During GIMPLE lowering, this operand becomes -->
     <!-- @code{NULL} and the body is emitted linearly after -->
     <!-- @code{OMP_PARALLEL}. -->
     <p>操作数<code>OMP_PARALLEL_BODY</code>在GENERIC和High GIMPLE形式中是有效的。
它包含了被所有线程执行的代码体。在GIMPLE下降过程中，
这个操作数变为<code>NULL</code>并且代码体被线性的输出在<code>OMP_PARALLEL</code>之后。

     <!-- Operand @code{OMP_PARALLEL_CLAUSES} is the list of clauses -->
     <!-- associated with the directive. -->
     <p>操作数<code>OMP_PARALLEL_CLAUSES</code>为与指令相关的子句列表。

     <!-- Operand @code{OMP_PARALLEL_FN} is created by -->
     <!-- @code{pass_lower_omp}, it contains the @code{FUNCTION_DECL} -->
     <!-- for the function that will contain the body of the parallel -->
     <!-- region. -->
     <p>操作数<code>OMP_PARALLEL_FN</code>由<code>pass_lower_omp</code>创建，
它包含了将要包含并行区域体的函数<code>FUNCTION_DECL</code>。

     <!-- Operand @code{OMP_PARALLEL_DATA_ARG} is also created by -->
     <!-- @code{pass_lower_omp}. If there are shared variables to be -->
     <!-- communicated to the children threads, this operand will contain -->
     <!-- the @code{VAR_DECL} that contains all the shared values and -->
     <!-- variables. -->
     <p>操作数<code>OMP_PARALLEL_DATA_ARG</code>也由<code>pass_lower_omp</code>创建。
如果有共享变量用于子线程间通讯，则该操作数将包含<code>VAR_DECL</code>，
其包含了所有共享的值和变量。

     <br><dt><code>OMP_FOR</code><dd>
<!-- Represents @code{#pragma omp for [clause1 @dots{} clauseN]}.  It -->
<!-- has 5 operands: -->
表示<code>#pragma omp for [clause1 ... clauseN]</code>. 其具有5个操作数：

     <!-- Operand @code{OMP_FOR_BODY} contains the loop body. -->
     <p>操作数OMP_FOR_BODY包含了循环体。

     <!-- Operand @code{OMP_FOR_CLAUSES} is the list of clauses -->
     <!-- associated with the directive. -->
     <p>操作数OMP_FOR_CLAUSES为与指令相关的子句列表。

     <!-- Operand @code{OMP_FOR_INIT} is the loop initialization code of -->
     <!-- the form @code{VAR = N1}. -->
     <p>操作数OMP_FOR_INIT为VAR = N1形式的循环初始化代码。

     <!-- Operand @code{OMP_FOR_COND} is the loop conditional expression -->
     <!-- of the form @code{VAR @{<,>,<=,>=@} N2}. -->
     <p>操作数OMP_FOR_COND为<code>VAR {&lt;,&gt;,&lt;=,&gt;=} N2</code>形式的循环条件表达式。

     <!-- Operand @code{OMP_FOR_INCR} is the loop index increment of the -->
     <!-- form @code{VAR @{+=,-=@} INCR}. -->
     <p>操作数OMP_FOR_INCR为<code>VAR {+=,-=} INCR</code>形式的循环索引增量。

     <!-- Operand @code{OMP_FOR_PRE_BODY} contains side-effect code from -->
     <!-- operands @code{OMP_FOR_INIT}, @code{OMP_FOR_COND} and -->
     <!-- @code{OMP_FOR_INC}.  These side-effects are part of the -->
     <!-- @code{OMP_FOR} block but must be evaluated before the start of -->
     <!-- loop body. -->
     <p>操作数OMP_FOR_PRE_BODY包含了来自操作数OMP_FOR_INIT, OMP_FOR_COND和OMP_FOR_INC的副作用代码。这些副作用为OMP_FOR块的一部分，但是必须在开始循环体之前被计算求值。

     <!-- The loop index variable @code{VAR} must be a signed integer variable, -->
     <!-- which is implicitly private to each thread.  Bounds -->
     <!-- @code{N1} and @code{N2} and the increment expression -->
     <!-- @code{INCR} are required to be loop invariant integer -->
     <!-- expressions that are evaluated without any synchronization. The -->
     <!-- evaluation order, frequency of evaluation and side-effects are -->
     <!-- unspecified by the standard. -->
     <p>循环索引变量VAR必须为单个整数变量，其隐式的归每个线程私有。边界N1和N2，以及增量表达式INCR需要为循环不变量整数表达式，其不需要同步就可以被计算求值。按照标准，计算求值的顺序，频率和副作用都没有被指定。

     <br><dt><code>OMP_SECTIONS</code><dd>
<!-- Represents @code{#pragma omp sections [clause1 @dots{} clauseN]}. -->
表示<code>#pragma omp sections [clause1 ... clauseN]</code>。

     <!-- Operand @code{OMP_SECTIONS_BODY} contains the sections body, -->
     <!-- which in turn contains a set of @code{OMP_SECTION} nodes for -->
     <!-- each of the concurrent sections delimited by @code{#pragma omp -->
     <!-- section}. -->
     <p>操作数<code>OMP_SECTIONS_BODY</code>包含了section主体，
其依次包含了一个<code>OMP_SECTION</code>节点集合，
每个并发的section通过<code>#pragma omp section</code>来划分。

     <!-- Operand @code{OMP_SECTIONS_CLAUSES} is the list of clauses -->
     <!-- associated with the directive. -->
     <p>操作数<code>OMP_SECTIONS_CLAUSES</code>为与指令相关的子句列表。

     <br><dt><code>OMP_SECTION</code><dd>
<!-- Section delimiter for @code{OMP_SECTIONS}. -->
<code>OMP_SECTIONS</code>的Section定界符。

     <br><dt><code>OMP_SINGLE</code><dd>
<!-- Represents @code{#pragma omp single}. -->
表示<code>#pragma omp single</code>

     <!-- Operand @code{OMP_SINGLE_BODY} contains the body of code to be -->
     <!-- executed by a single thread. -->
     <p>操作数<code>OMP_SINGLE_BODY</code>包含了被单个线程执行的代码体。

     <!-- Operand @code{OMP_SINGLE_CLAUSES} is the list of clauses -->
     <!-- associated with the directive. -->
     <p>操作数<code>OMP_SINGLE_CLAUSES</code>为与指令相关的子句列表。

     <br><dt><code>OMP_MASTER</code><dd>
<!-- Represents @code{#pragma omp master}. -->
表示<code>#pragma omp master</code>。

     <!-- Operand @code{OMP_MASTER_BODY} contains the body of code to be -->
     <!-- executed by the master thread. -->
     <p>操作数<code>OMP_MASTER_BODY</code>包含了被主控线程执行的代码体。

     <br><dt><code>OMP_ORDERED</code><dd>
<!-- Represents @code{#pragma omp ordered}. -->
表示<code>#pragma omp ordered</code>。

     <!-- Operand @code{OMP_ORDERED_BODY} contains the body of code to be -->
     <!-- executed in the sequential order dictated by the loop index -->
     <!-- variable. -->
     <p>操作数<code>OMP_ORDERED_BODY</code>包含了按照由循环索引变量所指示的顺序序列来执行的代码体。

     <br><dt><code>OMP_CRITICAL</code><dd>
<!-- Represents @code{#pragma omp critical [name]}. -->
表示<code>#pragma omp critical [name]</code>。

     <!-- Operand @code{OMP_CRITICAL_BODY} is the critical section. -->
     <p>操作数<code>OMP_CRITICAL_BODY</code>为临界section。

     <!-- Operand @code{OMP_CRITICAL_NAME} is an optional identifier to -->
     <!-- label the critical section. -->
     <p>操作数<code>OMP_CRITICAL_NAME</code>为可选的用来标记临界section的标识符。

     <br><dt><code>OMP_RETURN</code><dd>
<!-- This does not represent any OpenMP directive, it is an artificial -->
<!-- marker to indicate the end of the body of an OpenMP@. It is used -->
<!-- by the flow graph (@code{tree-cfg.c}) and OpenMP region -->
<!-- building code (@code{omp-low.c}). -->
这个并不表示任何OpenMP指令，它为一个人为标记用来指示OpenMP主体的结束。
其被用于流图（<code>tree-cfg.c</code>）和OpenMP区域构建代码（<code>omp-low.c</code>）。

     <br><dt><code>OMP_CONTINUE</code><dd>
<!-- Similarly, this instruction does not represent an OpenMP -->
<!-- directive, it is used by @code{OMP_FOR} and -->
<!-- @code{OMP_SECTIONS} to mark the place where the code needs to -->
<!-- loop to the next iteration (in the case of @code{OMP_FOR}) or -->
<!-- the next section (in the case of @code{OMP_SECTIONS}). -->
类似的，该指令不表示OpenMP指令，它被<code>OMP_FOR</code>和<code>OMP_SECTIONS</code>用于
标记代码需要循环到下一个迭代（例如<code>OMP_FOR</code>）或者下一个section
（例如<code>OMP_SECTIONS</code>）的地方。有一些情况，
<code>OMP_CONTINUE</code>被放在紧挨着<code>OMP_RETURN</code>之前。
但是，如果在循环体之后需要出现cleanups，
则它将被生成在<code>OMP_CONTINUE</code>和<code>OMP_RETURN</code>之间。

     <p>In some cases, <code>OMP_CONTINUE</code> is placed right before
<code>OMP_RETURN</code>.  But if there are cleanups that need to
occur right after the looping body, it will be emitted between
<code>OMP_CONTINUE</code> and <code>OMP_RETURN</code>.

     <br><dt><code>OMP_ATOMIC</code><dd>
<!-- Represents @code{#pragma omp atomic}. -->
表示<code>#pragma omp atomic</code>。

     <!-- Operand 0 is the address at which the atomic operation is to be -->
     <!-- performed. -->
     <p>操作数0是要被执行的原子操作的地址。

     <!-- Operand 1 is the expression to evaluate.  The gimplifier tries -->
     <!-- three alternative code generation strategies.  Whenever possible, -->
     <!-- an atomic update built-in is used.  If that fails, a -->
     <!-- compare-and-swap loop is attempted.  If that also fails, a -->
     <!-- regular critical section around the expression is used. -->
     <p>操作数1是要计算求值的表达式。gimplifier会尝试三种可供选择的代码生成策略。
只要可能，则会使用内建的原子更新。如果失败，
则会尝试进行比较-交换（compare-and-swap）循环。如果还是失败，
则会使用表达式附近的一个常规临界section。

     <br><dt><code>OMP_CLAUSE</code><dd>
<!-- Represents clauses associated with one of the @code{OMP_} directives. -->
<!-- Clauses are represented by separate sub-codes defined in -->
<!-- @file{tree.h}.  Clauses codes can be one of: -->
<!-- @code{OMP_CLAUSE_PRIVATE}, @code{OMP_CLAUSE_SHARED}, -->
<!-- @code{OMP_CLAUSE_FIRSTPRIVATE}, -->
<!-- @code{OMP_CLAUSE_LASTPRIVATE}, @code{OMP_CLAUSE_COPYIN}, -->
<!-- @code{OMP_CLAUSE_COPYPRIVATE}, @code{OMP_CLAUSE_IF}, -->
<!-- @code{OMP_CLAUSE_NUM_THREADS}, @code{OMP_CLAUSE_SCHEDULE}, -->
<!-- @code{OMP_CLAUSE_NOWAIT}, @code{OMP_CLAUSE_ORDERED}, -->
<!-- @code{OMP_CLAUSE_DEFAULT}, and @code{OMP_CLAUSE_REDUCTION}.  Each code -->
<!-- represents the corresponding OpenMP clause. -->
表示与<code>OMP_</code>指令相关的子句。子句使用<samp><span class="file">tree.h</span></samp>中定义的子代码单独表示。
子句代码可以为：OMP_CLAUSE_PRIVATE, OMP_CLAUSE_SHARED, OMP_CLAUSE_FIRSTPRIVATE, OMP_CLAUSE_LASTPRIVATE, OMP_CLAUSE_COPYIN, OMP_CLAUSE_COPYPRIVATE, OMP_CLAUSE_IF, OMP_CLAUSE_NUM_THREADS, OMP_CLAUSE_SCHEDULE, OMP_CLAUSE_NOWAIT, OMP_CLAUSE_ORDERED, OMP_CLAUSE_DEFAULT, 和OMP_CLAUSE_REDUCTION。每个代码表示了相应的OpenMP子句。

     <!-- Clauses associated with the same directive are chained together -->
     <!-- via @code{OMP_CLAUSE_CHAIN}. Those clauses that accept a list -->
     <!-- of variables are restricted to exactly one, accessed with -->
     <!-- @code{OMP_CLAUSE_VAR}.  Therefore, multiple variables under the -->
     <!-- same clause @code{C} need to be represented as multiple @code{C} clauses -->
     <!-- chained together.  This facilitates adding new clauses during -->
     <!-- compilation. -->
     <p>与同一指令相关的子句通过<code>OMP_CLAUSE_CHAIN</code>链接在一起。
那些接受一个变量列表的子句被限制为只有一个，使用<code>OMP_CLAUSE_VAR</code>来访问。
因此，同一子句<code>C</code>下的多个变量需要被多个链接在一起的<code>C</code>子句表示。
这样可以有助于在编译过程中增加新的子句。
</dl>

<!--  -->
<!-- Functions -->
<!--  -->
<!-- @node Functions -->
<!-- @section Functions -->
 </body></html>

