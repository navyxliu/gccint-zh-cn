<html lang="en">
<head>
<title>Host Common - GNU Compiler Collection (GCC) Internals</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="GNU Compiler Collection (GCC) Internals">
<meta name="generator" content="makeinfo 4.11">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="Host-Config.html#Host-Config" title="Host Config">
<link rel="next" href="Filesystem.html#Filesystem" title="Filesystem">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
Copyright (C) 1988, 1989, 1992, 1993, 1994, 1995, 1996, 1997, 1998,
1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007,
2008 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.2 or
any later version published by the Free Software Foundation; with the
Invariant Sections being ``Funding Free Software'', the Front-Cover
Texts being (a) (see below), and with the Back-Cover Texts being (b)
(see below).  A copy of the license is included in the section entitled
``GNU Free Documentation License''.

(a) The FSF's Front-Cover Text is:

     A GNU Manual

(b) The FSF's Back-Cover Text is:

     You have freedom to copy and modify this GNU Manual, like GNU
     software.  Copies published by the Free Software Foundation raise
     funds for GNU development.-->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<p>
<a name="Host-Common"></a>
Next:&nbsp;<a rel="next" accesskey="n" href="Filesystem.html#Filesystem">Filesystem</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="Host-Config.html#Host-Config">Host Config</a>
<hr>
</div>

<h3 class="section">18.1 Host Common</h3>

<p><a name="index-host-hooks-4728"></a><a name="index-host-functions-4729"></a>
有些东西不具有可移植性，甚至是在相似的操作系统之间，并且autoconf也难
以检测出。它们是通过钩子函数来实现的，这些函数放在 <samp><span class="file">config.gcc</span></samp>
中 <var>host_hook_obj</var> 变量指定的文件中。

<div class="defun">
&mdash; Host Hook: void <b>HOST_HOOKS_EXTRA_SIGNALS</b> (<var>void</var>)<var><a name="index-HOST_005fHOOKS_005fEXTRA_005fSIGNALS-4730"></a></var><br>
<blockquote><p>该主机钩子用于建立对额外信号的处理。最通用的事情是在这个钩子中去检测栈溢出。
</p></blockquote></div>

<div class="defun">
&mdash; Host Hook: void <b>*</b><var> HOST_HOOKS_GT_PCH_GET_ADDRESS </var>(<var>size_t size, int fd</var>)<var><a name="index-g_t_002a-4731"></a></var><br>
<blockquote><p>该主机钩子返回很可能在编译器的后续调用中为空闲的某块空间地址。我们打算将
PCH数据加载到这个地址，从而使得不需要对数据进行重定位。该区域应该能够容纳
<var>size</var> 个字节。如果主机使用 <code>mmap</code>，则 <var>fd</var> 为一个打开文件的
描述符，可以用来做探测。
</p></blockquote></div>

<div class="defun">
&mdash; Host Hook: int <b>HOST_HOOKS_GT_PCH_USE_ADDRESS</b> (<var>void * address, size_t size, int fd, size_t offset</var>)<var><a name="index-HOST_005fHOOKS_005fGT_005fPCH_005fUSE_005fADDRESS-4732"></a></var><br>
<blockquote><p>该主机钩子会在将要加载PCH文件时被调用。我们要从 <var>fd</var> 中加载 <var>size</var>
字节到内存中 <var>address</var> 地址的 <var>offset</var> 偏移量出。给定的 <var>address</var>
为之前调用 <code>HOST_HOOKS_GT_PCH_GET_ADDRESS</code> 所得的结果。如果不能在
<var>address</var> 处分配 <var>size</var> 个字节，则返回 &minus;1。如果分配了内
存但是没有加载数据，则返回0。如果该钩子完成了所有的事情，则返回1。

      <p>如果实现使用了保留地址空间，则会释放超出 <var>size</var> 的任何保留空间，而
不管返回值如何。如果不加载PCH，则该钩子可以使用 <var>size</var> 为0的方式调
用，这样所有保留地址空间将被释放。

      <p>不要试图不能被该执行程序返回的 <var>address</var> 值；直接返回 &minus;1。这
些值通常表明了一个过时的PCH文件（由其它GCC可执行程序创建的），并且该PCH
文件是无法工作的。
</p></blockquote></div>

<div class="defun">
&mdash; Host Hook: size_t <b>HOST_HOOKS_GT_PCH_ALLOC_GRANULARITY</b> (<var>void</var>)<var>;<a name="index-HOST_005fHOOKS_005fGT_005fPCH_005fALLOC_005fGRANULARITY-4733"></a></var><br>
<blockquote><p>该主机钩子返回分配虚拟内存所需的对齐大小。通常这与getpagesize相同，但是
在一些主机上，保留内存的对齐大小与供使用的内存页尺寸是不同的。
</p></blockquote></div>

 </body></html>

