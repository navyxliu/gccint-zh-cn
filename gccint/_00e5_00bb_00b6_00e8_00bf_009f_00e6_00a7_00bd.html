<html lang="zh">
<head>
<title>延迟槽 - GNU Compiler Collection (GCC) Internals</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="GNU Compiler Collection (GCC) Internals">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="Insn_00e5_00b1_009e_00e6_0080_00a7.html#Insn_00e5_00b1_009e_00e6_0080_00a7" title="Insn属性">
<link rel="prev" href="_00e5_00b8_00b8_00e9_0087_008f_00e5_00b1_009e_00e6_0080_00a7.html#g_t_00e5_00b8_00b8_00e9_0087_008f_00e5_00b1_009e_00e6_0080_00a7" title="常量属性">
<link rel="next" href="_00e5_00a4_0084_00e7_0090_0086_00e5_0099_00a8_00e6_00b5_0081_00e6_00b0_00b4_00e7_00ba_00bf_00e6_008f_008f_00e8_00bf_00b0.html#g_t_00e5_00a4_0084_00e7_0090_0086_00e5_0099_00a8_00e6_00b5_0081_00e6_00b0_00b4_00e7_00ba_00bf_00e6_008f_008f_00e8_00bf_00b0" title="处理器流水线描述">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
版权 (C) 1988, 1989, 1992, 1993, 1994, 1995, 1996, 1997, 1998,
1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008 自由软件基金会

您可以依据自由软件基金会所发行的GNU自由文档授权1.2版本或者之后的任何版本，
对本文档进行复制，分发和/或修改；其中不可变章节为"资助自由软件"，封面文
字为 (a) (参见下面)，以及封底文字为 (b) (参见下面)。授权的副本要被包含在
标题为"GNU自由文档授权"的章节中。

(a) FSF的封面文字为：

     GNU 手册

(b) FSF的封底文字为：

     您可以自由复制和修改本GNU手册，如同GNU软件。由自由软件基金会所发行
     的副本用于为GNU开发筹集资金。-->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<a name="%e5%bb%b6%e8%bf%9f%e6%a7%bd"></a>
<a name="g_t_00e5_00bb_00b6_00e8_00bf_009f_00e6_00a7_00bd"></a>
<p>
Next:&nbsp;<a rel="next" accesskey="n" href="_00e5_00a4_0084_00e7_0090_0086_00e5_0099_00a8_00e6_00b5_0081_00e6_00b0_00b4_00e7_00ba_00bf_00e6_008f_008f_00e8_00bf_00b0.html#g_t_00e5_00a4_0084_00e7_0090_0086_00e5_0099_00a8_00e6_00b5_0081_00e6_00b0_00b4_00e7_00ba_00bf_00e6_008f_008f_00e8_00bf_00b0">处理器流水线描述</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="_00e5_00b8_00b8_00e9_0087_008f_00e5_00b1_009e_00e6_0080_00a7.html#g_t_00e5_00b8_00b8_00e9_0087_008f_00e5_00b1_009e_00e6_0080_00a7">常量属性</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="Insn_00e5_00b1_009e_00e6_0080_00a7.html#Insn_00e5_00b1_009e_00e6_0080_00a7">Insn属性</a>
<hr>
</div>

<h4 class="subsection">16.19.7 延迟槽调度</h4>

<p><a name="index-delay-slots_002c-defining-3624"></a>
如果在一个目标机上存在延迟槽的话，insn属性机制可以用于指定对延迟槽的需求。
一条指令被称为需要延迟槽，
如果在物理上位于该指令之后的一些指令将被按照它们仿佛是位于之前的情况被执行。
典型的例子是分支和调用指令，其通常在执行分支或调用之前先执行后面的指令。

 <p>在一些机器上，条件分支指令可以选择性的废除（<dfn>annul</dfn>）延迟槽中的指令。
这意味着该指令对于特定的分支结果将不被执行。
对于分支为真时废除指令和分支为假时废除指令，这两种方式都被支持。

 <p>延迟槽调度与指令调度的不同之处在于，
判定一条指令是否需要延迟槽只依赖于正被生成的指令的类型，而不是指令间的数据流。
关于数据相关的指令调度的讨论，参见下一个章节。

 <p><a name="index-define_005fdelay-3625"></a>一个insn对一个或多个延迟槽的需求是通过<code>define_delay</code>表达式来表示的。
其具有下列形式：

<pre class="smallexample">     (define_delay <var>test</var>
                   [<var>delay-1</var> <var>annul-true-1</var> <var>annul-false-1</var>
                    <var>delay-2</var> <var>annul-true-2</var> <var>annul-false-2</var>
                    ...])
</pre>
 <p><var>test</var>是一个属性测试，用来表示该<code>define_delay</code>是否应用到特定的insn。
如果是，则所需延迟槽的数目通过作为第二个参数的向量的长度来确定。
放在延迟槽<var>n</var>中的insn必须满足属性测试<var>delay-n</var>。
<var>annul-true-n</var>是一个属性测试，用来指定当分支为真时哪些insn可以被废除。
如果该延迟槽不支持废除，则应该使用<code>(nil)</code>。

 <p>例如，通常情况下分支和调用insns都需要一个单个的延迟槽，
其可以包含任何不是分支或调用的其它insn，则下面的可以放入<samp><span class="file">md</span></samp>文件中：

<pre class="smallexample">     (define_delay (eq_attr "type" "branch,call")
                   [(eq_attr "type" "!branch,call") (nil) (nil)])
</pre>
 <p>可以指定多个<code>define_delay</code>表达式。在这种情况下，
每个这样的表达式都指定了不同的延迟槽需求，
并且在两个<code>define_delay</code>表达式中的test必须不能都为真。

 <p>例如，如果我们有一个机器，其对分支需要一个延迟槽，但对调用需要两个，
延迟槽不能包含分支或调用insn，并且当分支为真时，
任何在分支延迟槽中的有效insn可以被废除，则我们可以使用下列方式来表示：

<pre class="smallexample">     (define_delay (eq_attr "type" "branch")
        [(eq_attr "type" "!branch,call")
         (eq_attr "type" "!branch,call")
         (nil)])
     
     (define_delay (eq_attr "type" "call")
                   [(eq_attr "type" "!branch,call") (nil) (nil)
                    (eq_attr "type" "!branch,call") (nil) (nil)])
</pre>
 <!-- the above is *still* too long.  -mew 4feb93 -->
 </body></html>

