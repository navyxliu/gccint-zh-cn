<html lang="zh">
<head>
<title>常数 - GNU Compiler Collection (GCC) Internals</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="GNU Compiler Collection (GCC) Internals">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="RTL.html#RTL" title="RTL">
<link rel="prev" href="_00e6_009c_00ba_00e5_0099_00a8_00e6_00a8_00a1_00e5_00bc_008f.html#g_t_00e6_009c_00ba_00e5_0099_00a8_00e6_00a8_00a1_00e5_00bc_008f" title="机器模式">
<link rel="next" href="_00e5_00af_0084_00e5_00ad_0098_00e5_0099_00a8_00e5_0092_008c_00e5_0086_0085_00e5_00ad_0098.html#g_t_00e5_00af_0084_00e5_00ad_0098_00e5_0099_00a8_00e5_0092_008c_00e5_0086_0085_00e5_00ad_0098" title="寄存器和内存">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
版权 (C) 1988, 1989, 1992, 1993, 1994, 1995, 1996, 1997, 1998,
1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008 自由软件基金会

您可以依据自由软件基金会所发行的GNU自由文档授权1.2版本或者之后的任何版本，
对本文档进行复制，分发和/或修改；其中不可变章节为"资助自由软件"，封面文
字为 (a) (参见下面)，以及封底文字为 (b) (参见下面)。授权的副本要被包含在
标题为"GNU自由文档授权"的章节中。

(a) FSF的封面文字为：

     GNU 手册

(b) FSF的封底文字为：

     您可以自由复制和修改本GNU手册，如同GNU软件。由自由软件基金会所发行
     的副本用于为GNU开发筹集资金。-->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<a name="%e5%b8%b8%e6%95%b0"></a>
<a name="g_t_00e5_00b8_00b8_00e6_0095_00b0"></a>
<p>
Next:&nbsp;<a rel="next" accesskey="n" href="_00e5_00af_0084_00e5_00ad_0098_00e5_0099_00a8_00e5_0092_008c_00e5_0086_0085_00e5_00ad_0098.html#g_t_00e5_00af_0084_00e5_00ad_0098_00e5_0099_00a8_00e5_0092_008c_00e5_0086_0085_00e5_00ad_0098">寄存器和内存</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="_00e6_009c_00ba_00e5_0099_00a8_00e6_00a8_00a1_00e5_00bc_008f.html#g_t_00e6_009c_00ba_00e5_0099_00a8_00e6_00a8_00a1_00e5_00bc_008f">机器模式</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="RTL.html#RTL">RTL</a>
<hr>
</div>

<h3 class="section">10.7 常量表达式类型</h3>

<p><a name="index-RTL-constants-2347"></a><a name="index-RTL-constant-expression-types-2348"></a>
最简单的RTL表达式是那些对常数值的表示。

     
<a name="index-const_005fint-2349"></a>
<dl><dt><code>(const_int </code><var>i</var><code>)</code><dd>这类表达式表示整数值<var>i</var>。<var>i</var>通常通过宏<code>INTVAL</code>来访问，<code>INTVAL (</code><var>exp</var><code>)</code>相当于<code>XWINT (</code><var>exp</var><code>, 0)</code>，
为模式所生成的常量如果位数小于<code>HOST_WIDE_INT</code>，则必须符号扩展为全部宽度（例如，<code>gen_int_mode</code>）。

     <p><a name="index-const0_005frtx-2350"></a><a name="index-const1_005frtx-2351"></a><a name="index-const2_005frtx-2352"></a><a name="index-constm1_005frtx-2353"></a>只有一个表达式对象表示整数值0；是变量<code>const0_rtx</code>的值。同样的，整数值1的唯一表达式为<code>const1_rtx</code>，整数值2的唯一表达式为<code>const2_rtx</code>，负1的唯一表达式为<code>constm1_rtx</code>。任何试图去创建值为0，1，2或者-1的<code>const_int</code>都会返回相应的<code>const0_rtx</code>, <code>const1_rtx</code>, <code>const2_rtx</code>或者<code>constm1_rtx</code>。

     <p><a name="index-const_005ftrue_005frtx-2354"></a>类似的，只有一个对象表示值为<code>STORE_FLAG_VALUE</code>的整数，其为<code>const_true_rtx</code>。如果<code>STORE_FLAG_VALUE</code>为1，则<code>const_true_rtx</code>和<code>const1_rtx</code>将会指向同一对象。如果<code>STORE_FLAG_VALUE</code>为-1，<code>const_true_rtx</code>和<code>constm1_rtx</code>将会指向同一对象。

     <p><a name="index-const_005fdouble-2355"></a><br><dt><code>(const_double:</code><var>m</var> <var>i0</var> <var>i1</var><code> ...)</code><dd>表示或者为一个模式为<var>m</var>的浮点常量，或者为一个超过<code>HOST_BITS_PER_WIDE_INT</code>位的，但是小于其两倍的位数的整数常量（GCC并没有提供表示更大的常量的机制）。对于后者，<var>m</var>将为<code>VOIDmode</code>。

     <p><a name="index-CONST_005fDOUBLE_005fLOW-2356"></a>如果<var>m</var>为<code>VOIDmode</code>，则值的位数存储在<var>i0</var>和<var>i1</var>中。<var>i0</var>使用宏<code>CONST_DOUBLE_LOW</code>来访问，<var>i1</var>使用<code>CONST_DOUBLE_HIGH</code>。

     <p>如果常量为浮点（不管是什么精度），则用于存储值得整数数目取决于<code>REAL_VALUE_TYPE</code>的大小（see <a href="Floating-Point.html#Floating-Point">Floating Point</a>）。整数表示一个浮点数，但是不如target机器的或者host机器的浮点格式那么精确。要将它们转换为target机器使用的精确的位模式，使用宏<code>REAL_VALUE_TO_TARGET_DOUBLE</code>等（see <a href="Data-Output.html#Data-Output">Data Output</a>）。

     <p><a name="index-const_005ffixed-2357"></a><br><dt><code>(const_fixed:</code><var>m</var><code> ...)</code><dd>表示一个机器模式为<var>m</var>定点常量。操作数是一个类型为<code>struct fixed_value</code>数据结构，并使用宏<code>CONST_FIXED_VALUE</code>来访问。数据的高部分使用<code>CONST_FIXED_VALUE_HIGH</code>来访问；低部分使用<code>CONST_FIXED_VALUE_LOW</code>来访问。

     <p><a name="index-const_005fvector-2358"></a><br><dt><code>(const_vector:</code><var>m</var><code> [</code><var>x0</var> <var>x1</var><code> ...])</code><dd>表示一个向量常量。方括号代表向量包含的常量元素。<var>x0</var>，<var>x1</var>等等为<code>const_int</code>，<code>const_double</code>或者<code>const_fixed</code>元素。

     <p>在<code>const_vector</code>中的单元数可以通过宏<code>CONST_VECTOR_NUNITS</code>来获得，形如<code>CONST_VECTOR_NUNITS (</code><var>v</var><code>)</code>。

     <p>在向量常量中的单个元素使用宏<code>CONST_VECTOR_ELT</code>来访问，形如<code>CONST_VECTOR_ELT (</code><var>v</var><code>, </code><var>n</var><code>)</code>，其中<var>v</var>为向量常量，<var>n</var>为要访问的元素编号。

     <p><a name="index-const_005fstring-2359"></a><br><dt><code>(const_string </code><var>str</var><code>)</code><dd>表示一个具有值<var>str</var>的常量字符串。目前这只用于insn属性（see <a href="Insn-Attributes.html#Insn-Attributes">Insn Attributes</a>），因为C中的常量字符串存放在内存中。

     <p><a name="index-symbol_005fref-2360"></a><br><dt><code>(symbol_ref:</code><var>mode</var> <var>symbol</var><code>)</code><dd>表示引用数据的汇编标号的值。<var>symbol</var>为一个字符串，描述了汇编标号的名字。如果其起始于&lsquo;<samp><span class="samp">*</span></samp>&rsquo;，则标号为<var>symbol</var>不包含&lsquo;<samp><span class="samp">*</span></samp>&rsquo;的其余部分。否则，标号为<var>symbol</var>，通常具有前缀&lsquo;<samp><span class="samp">_</span></samp>&rsquo;。

     <p><code>symbol_ref</code>包含一个机器模式，其通常为<code>Pmode</code>。通常这是唯一的使得符号有效的机器模式。

     <p><a name="index-label_005fref-2361"></a><br><dt><code>(label_ref:</code><var>mode</var> <var>label</var><code>)</code><dd>表示引用代码的汇编标号的值。其包含一个操作数，一个表达式，其必须为一个<code>code_label</code>或者一个<code>NOTE_INSN_DELETED_LABEL</code>类型的<code>note</code>，其出现在指令序列中，来标识标号应该处于的位置。

     <p>对于代码标号引用，使用一个不同的表达式类型的原因是跳转优化可以区分它们。

     <p><code>label_ref</code>包含了一个机器模式，其通常为<code>Pmode</code>。通常这是唯一的使得标号有效的机器模式。

     <p><a name="index-const-2362"></a><br><dt><code>(const:</code><var>m</var> <var>exp</var><code>)</code><dd>表示一个常量，其为汇编时算术计算的结果。操作数<var>exp</var>，为一个表达式，只包含了<code>plus</code>和<code>minus</code>组合的常量（<code>const_int</code>, <code>symbol_ref</code> 和 <code>label_ref</code>表达式）。然而，并不是所有的组合都是有效的，因为汇编器不能对重定位符号做任意的算术运算。

     <p><var>m</var>应该为<code>Pmode</code>。

     <p><a name="index-high-2363"></a><br><dt><code>(high:</code><var>m</var> <var>exp</var><code>)</code><dd>表示<var>exp</var>的高位，通常为一个<code>symbol_ref</code>。位数是机器相关的并且通常为初始化一个寄存器的高位的指令所指定的位数。其和<code>lo_sum</code>一起使用来表示典型的用于RISC机器的双指令序列来引用一个全局内存位置。

     <p><var>m</var>应该为<code>Pmode</code>。

 </dl>

 <p><a name="index-CONST0_005fRTX-2364"></a><a name="index-CONST1_005fRTX-2365"></a><a name="index-CONST2_005fRTX-2366"></a>宏<code>CONST0_RTX (</code><var>mode</var><code>)</code>指定一个具有值0，机器模式为<var>mode</var>的表达式。如果<var>mode</var>为<code>MODE_INT</code>类别，则返回<code>const0_rtx</code>。如果<var>mode</var>为 <code>MODE_FLOAT</code>类别，则返回模式为<var>mode</var>的表达式<code>CONST_DOUBLE</code>。否则，其返回一个模式为<var>mode</var>的表达式<code>CONST_VECTOR</code>。类似的，宏<code>CONST1_RTX (</code><var>mode</var><code>)</code>指定一个具有值1，机器模式为<var>mode</var>的表达式，类似的对于<code>CONST2_RTX</code>。宏<code>CONST1_RTX</code>和<code>CONST2_RTX</code>对于向量模式没有定义。

 </body></html>

