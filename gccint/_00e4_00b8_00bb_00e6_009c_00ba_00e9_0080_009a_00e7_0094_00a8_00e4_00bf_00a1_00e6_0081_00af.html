<html lang="zh">
<head>
<title>主机通用信息 - GNU Compiler Collection (GCC) Internals</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="GNU Compiler Collection (GCC) Internals">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="_00e4_00b8_00bb_00e6_009c_00ba_00e9_0085_008d_00e7_00bd_00ae.html#g_t_00e4_00b8_00bb_00e6_009c_00ba_00e9_0085_008d_00e7_00bd_00ae" title="主机配置">
<link rel="next" href="_00e6_0096_0087_00e4_00bb_00b6_00e7_00b3_00bb_00e7_00bb_009f.html#g_t_00e6_0096_0087_00e4_00bb_00b6_00e7_00b3_00bb_00e7_00bb_009f" title="文件系统">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
版权 (C) 1988, 1989, 1992, 1993, 1994, 1995, 1996, 1997, 1998,
1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008 自由软件基金会

您可以依据自由软件基金会所发行的GNU自由文档授权1.2版本或者之后的任何版本，
对本文档进行复制，分发和/或修改；其中不可变章节为"资助自由软件"，封面文
字为 (a) (参见下面)，以及封底文字为 (b) (参见下面)。授权的副本要被包含在
标题为"GNU自由文档授权"的章节中。

(a) FSF的封面文字为：

     GNU 手册

(b) FSF的封底文字为：

     您可以自由复制和修改本GNU手册，如同GNU软件。由自由软件基金会所发行
     的副本用于为GNU开发筹集资金。-->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<a name="%e4%b8%bb%e6%9c%ba%e9%80%9a%e7%94%a8%e4%bf%a1%e6%81%af"></a>
<a name="g_t_00e4_00b8_00bb_00e6_009c_00ba_00e9_0080_009a_00e7_0094_00a8_00e4_00bf_00a1_00e6_0081_00af"></a>
<p>
Next:&nbsp;<a rel="next" accesskey="n" href="_00e6_0096_0087_00e4_00bb_00b6_00e7_00b3_00bb_00e7_00bb_009f.html#g_t_00e6_0096_0087_00e4_00bb_00b6_00e7_00b3_00bb_00e7_00bb_009f">文件系统</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="_00e4_00b8_00bb_00e6_009c_00ba_00e9_0085_008d_00e7_00bd_00ae.html#g_t_00e4_00b8_00bb_00e6_009c_00ba_00e9_0085_008d_00e7_00bd_00ae">主机配置</a>
<hr>
</div>

<h3 class="section">18.1 主机通用信息</h3>

<p><a name="index-host-hooks-4727"></a><a name="index-host-functions-4728"></a>
有些东西不具有可移植性，甚至是在相似的操作系统之间，并且autoconf也难
以检测出。它们是通过钩子函数来实现的，这些函数放在 <samp><span class="file">config.gcc</span></samp>
中 <var>host_hook_obj</var> 变量指定的文件中。

<div class="defun">
&mdash; Host Hook: void <b>HOST_HOOKS_EXTRA_SIGNALS</b> (<var>void</var>)<var><a name="index-HOST_005fHOOKS_005fEXTRA_005fSIGNALS-4729"></a></var><br>
<blockquote><p>该主机钩子用于建立对额外信号的处理。最通用的事情是在这个钩子中去检测栈溢出。
</p></blockquote></div>

<div class="defun">
&mdash; Host Hook: void <b>*</b><var> HOST_HOOKS_GT_PCH_GET_ADDRESS </var>(<var>size_t size, int fd</var>)<var><a name="index-g_t_002a-4730"></a></var><br>
<blockquote><p>该主机钩子返回很可能在编译器的后续调用中为空闲的某块空间地址。我们打算将
PCH数据加载到这个地址，从而使得不需要对数据进行重定位。该区域应该能够容纳
<var>size</var> 个字节。如果主机使用 <code>mmap</code>，则 <var>fd</var> 为一个打开文件的
描述符，可以用来做探测。
</p></blockquote></div>

<div class="defun">
&mdash; Host Hook: int <b>HOST_HOOKS_GT_PCH_USE_ADDRESS</b> (<var>void * address, size_t size, int fd, size_t offset</var>)<var><a name="index-HOST_005fHOOKS_005fGT_005fPCH_005fUSE_005fADDRESS-4731"></a></var><br>
<blockquote><p>该主机钩子会在将要加载PCH文件时被调用。我们要从 <var>fd</var> 中加载 <var>size</var>
字节到内存中 <var>address</var> 地址的 <var>offset</var> 偏移量出。给定的 <var>address</var>
为之前调用 <code>HOST_HOOKS_GT_PCH_GET_ADDRESS</code> 所得的结果。如果不能在
<var>address</var> 处分配 <var>size</var> 个字节，则返回 &minus;1。如果分配了内
存但是没有加载数据，则返回0。如果该钩子完成了所有的事情，则返回1。

      <p>如果实现使用了保留地址空间，则会释放超出 <var>size</var> 的任何保留空间，而
不管返回值如何。如果不加载PCH，则该钩子可以使用 <var>size</var> 为0的方式调
用，这样所有保留地址空间将被释放。

      <p>不要试图不能被该执行程序返回的 <var>address</var> 值；直接返回 &minus;1。这
些值通常表明了一个过时的PCH文件（由其它GCC可执行程序创建的），并且该PCH
文件是无法工作的。
</p></blockquote></div>

<div class="defun">
&mdash; Host Hook: size_t <b>HOST_HOOKS_GT_PCH_ALLOC_GRANULARITY</b> (<var>void</var>)<var>;<a name="index-HOST_005fHOOKS_005fGT_005fPCH_005fALLOC_005fGRANULARITY-4732"></a></var><br>
<blockquote><p>该主机钩子返回分配虚拟内存所需的对齐大小。通常这与getpagesize相同，但是
在一些主机上，保留内存的对齐大小与供使用的内存页尺寸是不同的。
</p></blockquote></div>

 </body></html>

