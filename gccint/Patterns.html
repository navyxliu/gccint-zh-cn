<html lang="en">
<head>
<title>Patterns - GNU Compiler Collection (GCC) Internals</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="GNU Compiler Collection (GCC) Internals">
<meta name="generator" content="makeinfo 4.11">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="Machine-Desc.html#Machine-Desc" title="Machine Desc">
<link rel="prev" href="Overview.html#Overview" title="Overview">
<link rel="next" href="Example.html#Example" title="Example">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
版权 (C) 1988, 1989, 1992, 1993, 1994, 1995, 1996, 1997, 1998,
1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008 自由软件基金会

您可以依据自由软件基金会所发行的GNU自由文档授权1.2版本或者之后的任何版本，
对本文档进行复制，分发和/或修改；其中不可变章节为"资助自由软件"，封面文
字为 (a) (参见下面)，以及封底文字为 (b) (参见下面)。授权的副本要被包含在
标题为"GNU自由文档授权"的章节中。

(a) FSF的封面文字为：

     GNU 手册

(b) FSF的封底文字为：

     您可以自由复制和修改本GNU手册，如同GNU软件。由自由软件基金会所发行
     的副本用于为GNU开发筹集资金。-->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<p>
<a name="Patterns"></a>
Next:&nbsp;<a rel="next" accesskey="n" href="Example.html#Example">Example</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="Overview.html#Overview">Overview</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="Machine-Desc.html#Machine-Desc">Machine Desc</a>
<hr>
</div>

<h3 class="section">16.2 Everything about Instruction Patterns</h3>

<p><a name="index-patterns-3156"></a><a name="index-instruction-patterns-3157"></a>
<a name="index-define_005finsn-3158"></a>每个指令模式包含了一个不完全的RTL表达式，和之后要被填充的部分；操作数约束，用来
限制如何填充那些部分；以及一个输出模式或者C代码来生成汇编输出。所有这些都由一个
 <code>define_insn</code> 表达式包裹起来。

 <p><code>define_insn</code> 是一个RTL表达式，包含了四或五个操作数：

     <ol type=1 start=1>
<li>一个可选的名字。存在名字表明该指令模式能够为编译器的RTL生成过程，执行一个确定的
标准工作。这个过程知道确定的名字，并且如果在机器描述中定义了这些名字，则会使用
它们的指令模式。

     <p>空字符串表示不存在名字。没有命名的指令模式是不会被用来生成RTL代码的，但是之后它
们能够用来组合多个简单insn。

     <p>不识别的并且因此不在RTL生成中使用的名字，没有任何作用，就像没有命名一样。

     <p>出于调试编译器的目的，你可能还需要指定一个名字起始于 &lsquo;<samp><span class="samp">*</span></samp>&rsquo; 字符。这样的名字只
被用来标识RTL dump中的指令，其它的都与没有命名的模式一样。

     <li><dfn>RTL template</dfn>（see <a href="RTL-Template.html#RTL-Template">RTL Template</a>）是一个不完全的RTL表达式向量，展示了这
条指令的样子。所谓不完全是因为它可以包含 <code>match_operand</code>,
<code>match_operator</code> 和 <code>match_dup</code> 表达式，用来表示指令的操作数。

     <p>如果向量只有一个元素，则那个元素为指令模式的模版。如果向量有多个元素，则指令模式是一个 <code>parallel</code> 表达式，包含了所描述的元素。

     <li><a name="index-pattern-conditions-3159"></a><a name="index-conditions_002c-in-patterns-3160"></a>一个条件。这是一个字符串，包含了一个C表达式用来最终测试，判定一个insn实体是否匹
配该模式。

     <p><a name="index-named-patterns-and-conditions-3161"></a>对于命名模式，条件（如果存在）可能不取决于要被匹配的insn的数据，而只是取决于
目标-机器-类型标记（target-machine-type flag）。编译器需要在初始化时测试这些条
件，以至于能够确切的知道在这一次运行中，哪些命名指令是可用的。

     <p><a name="index-operands-3162"></a>对于没有命名的模式，条件只用来匹配一个单独的insn，并且只在insn已经匹配了模式的识
别模版。insn的操作数可以为vector <code>operands</code>。对于一旦条件匹配的insn，它便不能被用来控制寄存器分配，例如用来排除某个硬件寄存器，或者硬件寄存器组合。

     <li><dfn>output template</dfn>：一个字符串，说明了如何将匹配的insn输出为汇编代码。字符串
中的 &lsquo;<samp><span class="samp">%</span></samp>&rsquo; 指定了替换一个操作数值的地方。see <a href="Output-Template.html#Output-Template">Output Template</a>。

     <p>当简单替换无法满足需求的时候，你可以指定一块C代码来计算输出。
see <a href="Output-Statement.html#Output-Statement">Output Statement</a>。

     <li>一个可选的向量，包含了匹配该模式的insn的属性值。see <a href="Insn-Attributes.html#Insn-Attributes">Insn Attributes</a>。

      </ol>

 </body></html>

